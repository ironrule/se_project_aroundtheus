!function(){"use strict";class e{constructor(e,t,s,r,i){this.card=e,this.name=e.name,this.link=e.link,this.cardID=e._id,this.isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=r,this.handleLikeClick=i}renderCard(){return this.cardElement=this._getTemplate(),this.cardElement.querySelector(".card__title").textContent=this.name,this.cardImageElement=this.cardElement.querySelector(".card__image"),this.likeButton=this.cardElement.querySelector(".card__like-button"),this.isLiked&&this.likeButton.classList.add("card__like-button_active"),this.deleteButton=this.cardElement.querySelector(".card__delete-button"),this.cardImageElement.src=this.link,this.cardImageElement.alt=this.name,this._setEventListeners(),this.cardElement}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}_setEventListeners(){this.cardImageElement.addEventListener("click",(()=>{this._handleImageClick(this)})),this.likeButton.addEventListener("click",this._handleLikeButton),this.deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)}))}_handleLikeButton=()=>{this.likeButton.classList.contains("card__like-button_active")?this.likeButton.classList.contains("card__like-button_active")&&(this.likeButton.classList.remove("card__like-button_active"),this.handleLikeClick(this.card,"removeLike")):(this.likeButton.classList.add("card__like-button_active"),this.handleLikeClick(this.card,"addLike"))}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formEl=t}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent=null,t.classList.remove(this._errorClass)}_toggleButtonState(){if(this._hasInvalidInput())return this._submitButton.classList.add(this._inactiveButtonClass),void(this._submitButton.disabled=!0);this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_setEventListeners(){this._inputEls=[...this._formEl.querySelectorAll(this._inputSelector)],this._submitButton=this._formEl.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}}const s=document.querySelector(".profile__edit-button"),r=document.querySelector(".profile__overlay-button"),i="#card-template",n=document.querySelector(".card__container"),o=document.querySelector(".profile__add-button");class a{constructor(e){this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__close"))&&this.close()}))}}class l extends a{constructor(e,t){super(e),this._formInputs=this._popupElement.querySelectorAll(".modal__input"),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._handleSubmit=this._handleSubmit.bind(this),this._popupButton=this._popupElement.querySelector(".modal__button")}_handleSubmit(e){this._popupButton.textContent="Saving...",e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t),this.close(),this._popupForm.reset()}_getInputValues(){return this._inputData={},this._formInputs.forEach((e=>{this._inputData[e.name]=e.value})),this._inputData}setInputValues(e){this._formInputs.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",this._handleSubmit)}}class d{constructor(e,t){let{items:s,renderer:r}=e;this._cardContainer=t,this._items=s,this._renderer=r}renderItems(){this._items.forEach((e=>{this._renderer(e,"append")}))}addItem(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"append";this._cardContainer[t](e)}}const c=new class{constructor(e){this._profileName=document.querySelector(e.name),this._profileDescription=document.querySelector(e.description),this._profileAvatar=document.querySelector(e.avatar)}getUserInfo(){return{title:this._profileName.textContent,description:this._profileDescription.textContent}}setUserInfo(e){let{name:t,description:s}=e;this._profileName.textContent=t,this._profileDescription.textContent=s}setUserAvatar(e){this._profileAvatar.src=e}}({name:".profile__name",description:".profile__description",avatar:".profile__image"}),h=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}initialSite(e){let[t,s]=e;Promise.all([t,s])}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setUserInfo(e,t){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"7d61f2da-4ddf-40b8-adec-eade6c2db478","Content-Type":"application/json"}}),u=new l("#modal__profile",(function(e){h.setUserInfo(e.title,e.description).then((()=>{c.setUserInfo({name:e.title,description:e.description})})).catch((e=>{console.error(e)}))})),_=new l("#modal__avatar",(function(e){h.setAvatar(e.url).then((e=>{c.setUserAvatar(e.avatar)})).catch((e=>{console.error(e)}))})),m=new d({},n),p=new l("#modal__add-card",(function(e){const t={name:e.title,link:e.url};h.addCard(t).then((e=>{L(e,"prepend")})).catch((e=>{console.error(e)}))})),E=new class extends a{constructor(e){super(e),this.imagePreview=this._popupElement.querySelector(".modal__preview-image"),this.imageCaption=this._popupElement.querySelector(".modal__preview-caption")}open(e){this.imagePreview.src=e.link,this.imagePreview.alt=e.name,this.imageCaption.textContent=e.name,super.open()}}("#modal__preview-wrapper"),v=new class extends a{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t}open(e){this.cardID=e,super.open()}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(()=>{this._handleFormSubmit(this.cardID),super.close()}))}}("#modal__delete-card",(function(e){h.deleteCard(e.cardID).then((()=>{e.cardElement.remove(),e.cardElement=null})).catch((e=>{console.error(e)}))})),f=(new e({},i,S,C,I),h.getUserInfo().then((e=>{var t;t=e,c.setUserInfo({name:t.name,description:t.about}),c.setUserAvatar(t.avatar)})).catch((e=>{console.error(e)}))),k=h.getInitialCards().then((e=>{new d({items:e,renderer:L},n).renderItems()})).catch((e=>{console.error(e)}));h.initialSite([f,k]);const b={};function L(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"append";const r=new e(t,i,S,C,I).renderCard();m.addItem(r,s)}function S(e){E.open(e)}function C(e){v.open(e)}function I(e,t){"addLike"===t&&h.addLike(e._id).catch((e=>{console.error(e)})),"removeLike"===t&&h.deleteLike(e._id).catch((e=>{console.error(e)}))}var y;y={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible",formSelector:".modal__form"},Array.from(document.querySelectorAll(y.formSelector)).forEach((e=>{const s=new t(y,e),r=e.getAttribute("name");b[r]=s,s.enableValidation()})),s.addEventListener("click",(function(){const e=c.getUserInfo();u.setInputValues(e),b["profile-form"].resetValidation(),u.open()})),o.addEventListener("click",(()=>{b["card-form"].resetValidation(),p.open()})),r.addEventListener("click",(()=>{b["avatar-form"].resetValidation(),_.open()})),E.setEventListeners(),u.setEventListeners(),_.setEventListeners(),p.setEventListeners(),v.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SSxFQUFlLGVBQWV0SCxrQkFDOUI4RyxFQUFnQmxGLE1BQU0sSUFFeEJzRixFQUFlbEYsb0JBQ2Z5RSxFQUFpQnpFLG9CQUNqQjhFLEVBQWdCOUUsb0JBQ2hCaUYsRUFBY2pGLG9CQUNkcUYsRUFBaUJyRixtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwRGVsZXRlQ29uZmlybWF0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIGhhbmRsZUxpa2VDbGlja1xyXG4gICkge1xyXG4gICAgdGhpcy5jYXJkID0gZGF0YTtcclxuICAgIHRoaXMubmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMubGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuY2FyZElEID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLmlzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XHJcbiAgICB0aGlzLmhhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcclxuICB9XHJcblxyXG4gIHJlbmRlckNhcmQoKSB7XHJcbiAgICB0aGlzLmNhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKS50ZXh0Q29udGVudCA9IHRoaXMubmFtZTtcclxuICAgIHRoaXMuY2FyZEltYWdlRWxlbWVudCA9IHRoaXMuY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMubGlrZUJ1dHRvbiA9IHRoaXMuY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIGlmICh0aGlzLmlzTGlrZWQpIHtcclxuICAgICAgdGhpcy5saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgICB0aGlzLmRlbGV0ZUJ1dHRvbiA9IHRoaXMuY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5jYXJkSW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMubGluaztcclxuICAgIHRoaXMuY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLm5hbWU7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgcmV0dXJuIHRoaXMuY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICByZXR1cm4gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLmNhcmRJbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKTtcclxuICAgIHRoaXMuZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTGlrZUJ1dHRvbiA9ICgpID0+IHtcclxuICAgIGlmICghdGhpcy5saWtlQnV0dG9uLmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKSkge1xyXG4gICAgICB0aGlzLmxpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgICAgdGhpcy5oYW5kbGVMaWtlQ2xpY2sodGhpcy5jYXJkLCBcImFkZExpa2VcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAodGhpcy5saWtlQnV0dG9uLmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKSkge1xyXG4gICAgICAgIHRoaXMubGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlTGlrZUNsaWNrKHRoaXMuY2FyZCwgXCJyZW1vdmVMaWtlXCIpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5nc09iamVjdCwgZm9ybUVsKSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3NPYmplY3QuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3NPYmplY3Quc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3NPYmplY3QuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzT2JqZWN0LmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5nc09iamVjdC5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZm9ybUVsID0gZm9ybUVsO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VJbnB1dEVsID0gdGhpcy5faW5wdXRFbHM7XHJcbiAgICBlcnJvck1lc3NhZ2VJbnB1dEVsLmZvckVhY2goKGVycm9yTWVzc2FnZUlucHV0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGVycm9yTWVzc2FnZUlucHV0KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiAhdGhpcy5faW5wdXRFbHMuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XHJcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IG51bGw7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsIi8qKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqICAgICAgIEZvcm1WYWxpZGF0b3IgQ29uZmlnIE9iamVjdFxyXG4gKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSoqL1xyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBhcGlDb25maWcgPSB7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiN2Q2MWYyZGEtNGRkZi00MGI4LWFkZWMtZWFkZTZjMmRiNDc4XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59O1xyXG4vKio9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gKiBQcm9maWxlIGFuZCBwcm9maWxlIG1vZGFsIHNlbGVjdG9yIHZhcmlhYmxlc1xyXG4gKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSoqL1xyXG5leHBvcnQgY29uc3Qgb3BlblByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IG9wZW5BdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX292ZXJsYXktYnV0dG9uXCJcclxuKTtcclxuLyoqPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICogICAgICAgQ2FyZCB0ZW1wbGF0ZSBzZWxlY3RvciB2YXJpYWJsZXNcclxuICo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qKi9cclxuZXhwb3J0IGNvbnN0IGNhcmRTZWxlY3RvciA9IFwiI2NhcmQtdGVtcGxhdGVcIjtcclxuZXhwb3J0IGNvbnN0IGNhcmRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2NvbnRhaW5lclwiKTtcclxuZXhwb3J0IGNvbnN0IG9wZW5DYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgY2FyZEVsZW1lbnQgPSB7fTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlKGUpIHtcclxuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChlKSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikgfHxcclxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fZm9ybUlucHV0cyA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSB0aGlzLl9oYW5kbGVTdWJtaXQuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX3BvcHVwQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVTdWJtaXQoZXZ0KSB7XHJcbiAgICB0aGlzLl9wb3B1cEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnN0IGZvcm1EYXRhID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoZm9ybURhdGEpO1xyXG4gICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dERhdGEgPSB7fTtcclxuICAgIHRoaXMuX2Zvcm1JbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5faW5wdXREYXRhW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dERhdGE7XHJcbiAgfVxyXG5cclxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XHJcbiAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5faGFuZGxlU3VibWl0KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY2FyZENvbnRhaW5lcikge1xyXG4gICAgdGhpcy5fY2FyZENvbnRhaW5lciA9IGNhcmRDb250YWluZXI7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtLCBcImFwcGVuZFwiKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShpdGVtLCBtZXRob2QgPSBcImFwcGVuZFwiKSB7XHJcbiAgICB0aGlzLl9jYXJkQ29udGFpbmVyW21ldGhvZF0oaXRlbSk7XHJcbiAgfVxyXG59XHJcbiIsIi8qKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqICAgICAgICAgIEltcG9ydCBDU1MgZm9yIFdlYnBhY2tcclxuICo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qKi9cclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuLyoqPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICogICAgICAgICAgSW1wb3J0IENsYXNzZXMgYW5kIE9iamVjdHNcclxuICo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qKi9cclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgY29uZmlnLFxyXG4gIGFwaUNvbmZpZyxcclxuICBvcGVuUHJvZmlsZUJ1dHRvbixcclxuICBvcGVuQXZhdGFyQnV0dG9uLFxyXG4gIGNhcmRTZWxlY3RvcixcclxuICBjYXJkQ29udGFpbmVyLFxyXG4gIG9wZW5DYXJkQnV0dG9uLFxyXG4gIGNhcmRFbGVtZW50LFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwRGVsZXRlQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwRGVsZXRlQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcbi8qKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqICAgICAgICAgICAgQ2xhc3MgSW5zdGFudGlhdGlvbnNcclxuICo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qKi9cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWU6IFwiLnByb2ZpbGVfX25hbWVcIixcclxuICBkZXNjcmlwdGlvbjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcclxuICBhdmF0YXI6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXHJcbn0pO1xyXG5jb25zdCBhcGkgPSBuZXcgQXBpKGFwaUNvbmZpZyk7XHJcbmNvbnN0IHByb2ZpbGVQb3B1cEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNtb2RhbF9fcHJvZmlsZVwiLFxyXG4gIGhhbmRsZVByb2ZpbGVTdWJtaXRcclxuKTtcclxuY29uc3QgYXZhdGFyUG9wdXBGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjbW9kYWxfX2F2YXRhclwiLCBoYW5kbGVBdmF0YXJTdWJtaXQpO1xyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKHt9LCBjYXJkQ29udGFpbmVyKTtcclxuY29uc3QgY2FyZFBvcHVwRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI21vZGFsX19hZGQtY2FyZFwiLCBoYW5kbGVDYXJkU3VibWl0KTtcclxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjbW9kYWxfX3ByZXZpZXctd3JhcHBlclwiKTtcclxuY29uc3Qgb3BlbkNvbmZpcm1hdGlvbiA9IG5ldyBQb3B1cERlbGV0ZUNvbmZpcm1hdGlvbihcclxuICBcIiNtb2RhbF9fZGVsZXRlLWNhcmRcIixcclxuICBkZWxldGVDb25maXJtZWRcclxuKTtcclxuY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gIGNhcmRFbGVtZW50LFxyXG4gIGNhcmRTZWxlY3RvcixcclxuICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gIGhhbmRsZURlbGV0ZUNsaWNrLFxyXG4gIGhhbmRsZUxpa2VDbGlja1xyXG4pO1xyXG4vKio9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gKiAgICAgIFZhbGlkYXRpb24gYW5kIENhcmQgQ2xhc3MgQ2FsbHNcclxuICo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qKi9cclxuY29uc3QgZ2V0VXNlckluZm8gPSBhcGlcclxuICAuZ2V0VXNlckluZm8oKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIGdldEluaXRpYWxBcGlVc2VySW5mbyhyZXMpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICB9KTtcclxuY29uc3QgZ2V0Q2FyZEluZm8gPSBhcGlcclxuICAuZ2V0SW5pdGlhbENhcmRzKClcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICBoYW5kbGVBcGlDYXJkSW5mbyhyZXMpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICB9KTtcclxuYXBpLmluaXRpYWxTaXRlKFtnZXRVc2VySW5mbywgZ2V0Q2FyZEluZm9dKTtcclxuXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGZvcm1FbGVtZW50KTtcclxuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcclxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgfSk7XHJcbn07XHJcbmVuYWJsZVZhbGlkYXRpb24oY29uZmlnKTtcclxuLyoqPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICogICAgICAgICAgICAgICBGdW5jdGlvbnNcclxuICo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qKi9cclxuZnVuY3Rpb24gaGFuZGxlQXBpQ2FyZEluZm8oY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkQXBpU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgeyBpdGVtczogY2FyZERhdGEsIHJlbmRlcmVyOiByZW5kZXJDYXJkIH0sXHJcbiAgICBjYXJkQ29udGFpbmVyXHJcbiAgKTtcclxuICBjYXJkQXBpU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG59XHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoaXRlbSwgbWV0aG9kID0gXCJhcHBlbmRcIikge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGl0ZW0sXHJcbiAgICBjYXJkU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQ2xpY2tcclxuICApO1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5yZW5kZXJDYXJkKCk7XHJcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCwgbWV0aG9kKTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGRhdGEpIHtcclxuICBwb3B1cFdpdGhJbWFnZS5vcGVuKGRhdGEpO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNsaWNrKGNhcmQpIHtcclxuICBvcGVuQ29uZmlybWF0aW9uLm9wZW4oY2FyZCk7XHJcbn1cclxuZnVuY3Rpb24gZGVsZXRlQ29uZmlybWVkKGNhcmQpIHtcclxuICBhcGlcclxuICAgIC5kZWxldGVDYXJkKGNhcmQuY2FyZElEKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBjYXJkLmNhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICBjYXJkLmNhcmRFbGVtZW50ID0gbnVsbDtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2xpY2soY2FyZCwgbGlrZUFjdGlvbikge1xyXG4gIGlmIChsaWtlQWN0aW9uID09PSBcImFkZExpa2VcIikge1xyXG4gICAgYXBpLmFkZExpa2UoY2FyZC5faWQpLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGlmIChsaWtlQWN0aW9uID09PSBcInJlbW92ZUxpa2VcIikge1xyXG4gICAgYXBpLmRlbGV0ZUxpa2UoY2FyZC5faWQpLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbmZ1bmN0aW9uIGdldEluaXRpYWxBcGlVc2VySW5mbyh1c2VyRGF0YSkge1xyXG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXHJcbiAgICBkZXNjcmlwdGlvbjogdXNlckRhdGEuYWJvdXQsXHJcbiAgfSk7XHJcbiAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVTdWJtaXQodXNlckRhdGEpIHtcclxuICBhcGlcclxuICAgIC5zZXRVc2VySW5mbyh1c2VyRGF0YS50aXRsZSwgdXNlckRhdGEuZGVzY3JpcHRpb24pXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgICBuYW1lOiB1c2VyRGF0YS50aXRsZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogdXNlckRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgIH0pO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChkYXRhKSB7XHJcbiAgYXBpXHJcbiAgICAuc2V0QXZhdGFyKGRhdGEudXJsKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHJlcy5hdmF0YXIpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRTdWJtaXQoZGF0YSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0geyBuYW1lOiBkYXRhLnRpdGxlLCBsaW5rOiBkYXRhLnVybCB9O1xyXG4gIGFwaVxyXG4gICAgLmFkZENhcmQoY2FyZEVsZW1lbnQpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJlbmRlckNhcmQocmVzLCBcInByZXBlbmRcIik7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgfSk7XHJcbn1cclxuLyoqPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICogICAgICAgICAgICAgICBFdmVudCBMaXN0ZW5lcnNcclxuICo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qKi9cclxub3BlblByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVBvcHVwRm9ybS5zZXRJbnB1dFZhbHVlcyh1c2VyRGF0YSk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJwcm9maWxlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgcHJvZmlsZVBvcHVwRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG5vcGVuQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wiY2FyZC1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGNhcmRQb3B1cEZvcm0ub3BlbigpO1xyXG59KTtcclxub3BlbkF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wiYXZhdGFyLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYXZhdGFyUG9wdXBGb3JtLm9wZW4oKTtcclxufSk7XHJcbnBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbnByb2ZpbGVQb3B1cEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYXZhdGFyUG9wdXBGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNhcmRQb3B1cEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxub3BlbkNvbmZpcm1hdGlvbi5zZXRFdmVudExpc3RlbmVycygpO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IodXNlckRhdGEpIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyRGF0YS5uYW1lKTtcclxuICAgIHRoaXMuX3Byb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckRhdGEuZGVzY3JpcHRpb24pO1xyXG4gICAgdGhpcy5fcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckRhdGEuYXZhdGFyKTtcclxuICB9XHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB0aXRsZTogdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX3Byb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gIH1cclxuICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xyXG4gICAgdGhpcy5fcHJvZmlsZUF2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBpbml0aWFsU2l0ZShbZ2V0VXNlckluZm8sIGdldENhcmRJbmZvXSkge1xyXG4gICAgUHJvbWlzZS5hbGwoW2dldFVzZXJJbmZvLCBnZXRDYXJkSW5mb10pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhuYW1lLCBhYm91dCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBhYm91dCB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRBdmF0YXIoYXZhdGFyVXJsKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXI6IGF2YXRhclVybCB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkKGNhcmREYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZTogY2FyZERhdGEubmFtZSwgbGluazogY2FyZERhdGEubGluayB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJRCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElEfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZExpa2UoY2FyZElEKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSUR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlTGlrZShjYXJkSUQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJRH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLmltYWdlUHJldmlldyA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5pbWFnZUNhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX3ByZXZpZXctY2FwdGlvblwiXHJcbiAgICApO1xyXG4gIH1cclxuICBvcGVuKGRhdGEpIHtcclxuICAgIHRoaXMuaW1hZ2VQcmV2aWV3LnNyYyA9IGRhdGEubGluaztcclxuICAgIHRoaXMuaW1hZ2VQcmV2aWV3LmFsdCA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuaW1hZ2VDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwRGVsZXRlQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIC8vIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IHRoaXMuX2hhbmRsZVN1Ym1pdC5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgb3BlbihjYXJkSUQpIHtcclxuICAgIHRoaXMuY2FyZElEID0gY2FyZElEO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuY2FyZElEKTtcclxuICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsInRoaXMiLCJjYXJkIiwibmFtZSIsImxpbmsiLCJjYXJkSUQiLCJfaWQiLCJpc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwicmVuZGVyQ2FyZCIsImNhcmRFbGVtZW50IiwiX2dldFRlbXBsYXRlIiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50IiwiY2FyZEltYWdlRWxlbWVudCIsImxpa2VCdXR0b24iLCJjbGFzc0xpc3QiLCJhZGQiLCJkZWxldGVCdXR0b24iLCJzcmMiLCJhbHQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImNsb25lTm9kZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsImNvbnRhaW5zIiwicmVtb3ZlIiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzT2JqZWN0IiwiZm9ybUVsIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfaW5wdXRFbHMiLCJmb3JFYWNoIiwiZXJyb3JNZXNzYWdlSW5wdXQiLCJfaGlkZUlucHV0RXJyb3IiLCJfaGFzSW52YWxpZElucHV0IiwiZXZlcnkiLCJpbnB1dEVsIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJxdWVyeVNlbGVjdG9yQWxsIiwib3BlblByb2ZpbGVCdXR0b24iLCJvcGVuQXZhdGFyQnV0dG9uIiwiY2FyZENvbnRhaW5lciIsIm9wZW5DYXJkQnV0dG9uIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2Zvcm1JbnB1dHMiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaGFuZGxlU3VibWl0IiwiX3BvcHVwQnV0dG9uIiwiZXZ0IiwiZm9ybURhdGEiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJyZXNldCIsIl9pbnB1dERhdGEiLCJpbnB1dCIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJTZWN0aW9uIiwiX3JlZiIsIml0ZW1zIiwicmVuZGVyZXIiLCJfY2FyZENvbnRhaW5lciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJtZXRob2QiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJ1c2VySW5mbyIsInVzZXJEYXRhIiwiX3Byb2ZpbGVOYW1lIiwiX3Byb2ZpbGVEZXNjcmlwdGlvbiIsImRlc2NyaXB0aW9uIiwiX3Byb2ZpbGVBdmF0YXIiLCJhdmF0YXIiLCJnZXRVc2VySW5mbyIsInRpdGxlIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiaW5pdGlhbFNpdGUiLCJfcmVmMiIsImdldENhcmRJbmZvIiwiUHJvbWlzZSIsImFsbCIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsImFib3V0IiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzZXRBdmF0YXIiLCJhdmF0YXJVcmwiLCJnZXRJbml0aWFsQ2FyZHMiLCJhZGRDYXJkIiwiY2FyZERhdGEiLCJkZWxldGVDYXJkIiwiYWRkTGlrZSIsImRlbGV0ZUxpa2UiLCJhdXRob3JpemF0aW9uIiwicHJvZmlsZVBvcHVwRm9ybSIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiYXZhdGFyUG9wdXBGb3JtIiwidXJsIiwiY2FyZFNlY3Rpb24iLCJjYXJkUG9wdXBGb3JtIiwicG9wdXBXaXRoSW1hZ2UiLCJpbWFnZVByZXZpZXciLCJpbWFnZUNhcHRpb24iLCJvcGVuQ29uZmlybWF0aW9uIiwiZm9ybVZhbGlkYXRvcnMiLCJsaWtlQWN0aW9uIiwiY29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiQXJyYXkiLCJmcm9tIiwiZm9ybUVsZW1lbnQiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSJdLCJzb3VyY2VSb290IjoiIn0=