!function(){"use strict";class e{constructor(e,t,s,i,r){this.card=e,this.name=e.name,this.link=e.link,this.cardID=e._id,this.isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=i,this.handleLikeClick=r}renderCard(){return this.cardElement=this._getTemplate(),this.cardElement.querySelector(".card__title").textContent=this.name,this.cardImageElement=this.cardElement.querySelector(".card__image"),this.likeButton=this.cardElement.querySelector(".card__like-button"),this.isLiked&&this.likeButton.classList.add("card__like-button_active"),this.deleteButton=this.cardElement.querySelector(".card__delete-button"),this.cardImageElement.src=this.link,this.cardImageElement.alt=this.name,this._setEventListeners(),this.cardElement}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}_setEventListeners(){this.cardImageElement.addEventListener("click",(()=>{this._handleImageClick(this)})),this.likeButton.addEventListener("click",this._handleLikeButton),this.deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this)}))}_handleLikeButton=()=>{this.likeButton.classList.contains("card__like-button_active")?this.likeButton.classList.contains("card__like-button_active")&&this.handleLikeClick(this,this.card,"removeLike"):this.handleLikeClick(this,this.card,"addLike")}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formEl=t}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent=null,t.classList.remove(this._errorClass)}_toggleButtonState(){if(this._hasInvalidInput())return this._submitButton.classList.add(this._inactiveButtonClass),void(this._submitButton.disabled=!0);this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_setEventListeners(){this._inputEls=[...this._formEl.querySelectorAll(this._inputSelector)],this._submitButton=this._formEl.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}}const s=document.querySelector(".profile__edit-button"),i=document.querySelector(".profile__overlay-button"),r="#card-template",n=document.querySelector(".card__container"),o=document.querySelector(".profile__add-button");class a{constructor(e){this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__close"))&&this.close()}))}}class l extends a{constructor(e,t){super(e),this._formInputs=this._popupElement.querySelectorAll(".modal__input"),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._handleSubmit=this._handleSubmit.bind(this),this._submitBtn=this._popupElement.querySelector(".modal__button"),this._submitBtnText=this._submitBtn.textContent}_handleSubmit(e){e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t)}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}popupFormReset(){this._popupForm.reset()}_getInputValues(){return this._inputData={},this._formInputs.forEach((e=>{this._inputData[e.name]=e.value})),this._inputData}setInputValues(e){this._formInputs.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",this._handleSubmit)}}class d{constructor(e,t){let{items:s,renderer:i}=e;this._cardContainer=t,this._items=s,this._renderer=i}renderItems(){this._items.forEach((e=>{this._renderer(e,"append")}))}addItem(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"append";this._cardContainer[t](e)}}const c=new class{constructor(e){this._profileName=document.querySelector(e.name),this._profileDescription=document.querySelector(e.description),this._profileAvatar=document.querySelector(e.avatar)}getUserInfo(){return{title:this._profileName.textContent,description:this._profileDescription.textContent}}setUserInfo(e){let{name:t,description:s}=e;this._profileName.textContent=t,this._profileDescription.textContent=s}setUserAvatar(e){this._profileAvatar.src=e}}({name:".profile__name",description:".profile__description",avatar:".profile__image"}),h=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(this._baseUrl+e,t).then(this._checkResponse)}initialSite(e){let[t,s]=e;Promise.all([t,s])}getUserInfo(){return this._request("/users/me",{method:"GET",headers:this._headers})}setUserInfo(e,t){return this._request("/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})})}setAvatar(e){return this._request("/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}getInitialCards(){return this._request("/cards",{method:"GET",headers:this._headers})}addCard(e){return this._request("/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})})}deleteCard(e){return this._request(`/cards/${e}`,{method:"DELETE",headers:this._headers})}addLike(e){return this._request(`/cards/${e}/likes`,{method:"PUT",headers:this._headers})}deleteLike(e){return this._request(`/cards/${e}/likes`,{method:"DELETE",headers:this._headers})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"7d61f2da-4ddf-40b8-adec-eade6c2db478","Content-Type":"application/json"}}),u=new l("#modal__profile",(function(e){u.renderLoading(!0,"Saving..."),h.setUserInfo(e.title,e.description).then((()=>{c.setUserInfo({name:e.title,description:e.description})})).then((()=>{u.close(),u.popupFormReset()})).catch(console.error).finally((()=>{u.renderLoading(!1)}))})),_=new l("#modal__avatar",(function(e){_.renderLoading(!0,"Saving..."),h.setAvatar(e.url).then((e=>{c.setUserAvatar(e.avatar)})).then((()=>{_.close(),_.popupFormReset()})).catch(console.error).finally((()=>{_.renderLoading(!1)}))})),m=new d({},n),p=new l("#modal__add-card",(function(e){p.renderLoading(!0,"Saving...");const t={name:e.title,link:e.url};h.addCard(t).then((e=>{L(e,"prepend")})).then((()=>{p.close(),p.popupFormReset()})).catch(console.error).finally((()=>{p.renderLoading(!1)}))})),v=new class extends a{constructor(e){super(e),this.imagePreview=this._popupElement.querySelector(".modal__preview-image"),this.imageCaption=this._popupElement.querySelector(".modal__preview-caption")}open(e){this.imagePreview.src=e.link,this.imagePreview.alt=e.name,this.imageCaption.textContent=e.name,super.open()}}("#modal__preview-wrapper"),E=new class extends a{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._popupButton=this._popupElement.querySelector(".modal__button")}open(e){this._popupButton.textContent="Yes",this.cardID=e,super.open()}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(()=>{this._popupButton.textContent="Saving...",this._handleFormSubmit(this.cardID)}))}}("#modal__delete-card",(function(e){h.deleteCard(e.cardID).then((()=>{e.cardElement.remove(),e.cardElement=null})).then(E.close()).catch(console.error)}));new e({},r,b,k,S),Promise.all([h.getUserInfo(),h.getInitialCards()]).then((e=>{const t=e[0],s=Array.from(e[1]);!function(e){c.setUserInfo({name:e.name,description:e.about}),c.setUserAvatar(e.avatar)}(t),new d({items:s,renderer:L},n).renderItems()})).catch(console.error);const f={};function L(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"append";const i=new e(t,r,b,k,S).renderCard();m.addItem(i,s)}function b(e){v.open(e)}function k(e){E.open(e)}function S(e,t,s){"addLike"===s&&h.addLike(t._id).then(e.likeButton.classList.add("card__like-button_active")).catch((e=>{console.error(e)})),"removeLike"===s&&h.deleteLike(t._id).then(e.likeButton.classList.remove("card__like-button_active")).catch((e=>{console.error(e)}))}var C;C={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible",formSelector:".modal__form"},Array.from(document.querySelectorAll(C.formSelector)).forEach((e=>{const s=new t(C,e),i=e.getAttribute("name");f[i]=s,s.enableValidation()})),s.addEventListener("click",(function(){const e=c.getUserInfo();u.setInputValues(e),f["profile-form"].resetValidation(),u.open()})),o.addEventListener("click",(()=>{f["card-form"].resetValidation(),p.open()})),i.addEventListener("click",(()=>{f["avatar-form"].resetValidation(),_.open()})),v.setEventListeners(),u.setEventListeners(),_.setEventListeners(),p.setEventListeners(),E.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQWUsTUFBTUEsRUFDbkJDLFdBQUFBLENBQ0VDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBRUFDLEtBQUtDLEtBQU9OLEVBQ1pLLEtBQUtFLEtBQU9QLEVBQUtPLEtBQ2pCRixLQUFLRyxLQUFPUixFQUFLUSxLQUNqQkgsS0FBS0ksT0FBU1QsRUFBS1UsSUFDbkJMLEtBQUtNLFFBQVVYLEVBQUtXLFFBQ3BCTixLQUFLTyxjQUFnQlgsRUFDckJJLEtBQUtRLGtCQUFvQlgsRUFDekJHLEtBQUtTLG1CQUFxQlgsRUFDMUJFLEtBQUtELGdCQUFrQkEsQ0FDekIsQ0FFQVcsVUFBQUEsR0FZRSxPQVhBVixLQUFLVyxZQUFjWCxLQUFLWSxlQUN4QlosS0FBS1csWUFBWUUsY0FBYyxnQkFBZ0JDLFlBQWNkLEtBQUtFLEtBQ2xFRixLQUFLZSxpQkFBbUJmLEtBQUtXLFlBQVlFLGNBQWMsZ0JBQ3ZEYixLQUFLZ0IsV0FBYWhCLEtBQUtXLFlBQVlFLGNBQWMsc0JBQzdDYixLQUFLTSxTQUNQTixLQUFLZ0IsV0FBV0MsVUFBVUMsSUFBSSw0QkFFaENsQixLQUFLbUIsYUFBZW5CLEtBQUtXLFlBQVlFLGNBQWMsd0JBQ25EYixLQUFLZSxpQkFBaUJLLElBQU1wQixLQUFLRyxLQUNqQ0gsS0FBS2UsaUJBQWlCTSxJQUFNckIsS0FBS0UsS0FDakNGLEtBQUtzQixxQkFDRXRCLEtBQUtXLFdBQ2QsQ0FFQUMsWUFBQUEsR0FDRSxPQUFPVyxTQUNKVixjQUFjYixLQUFLTyxlQUNuQmlCLFFBQVFDLGtCQUFrQkMsV0FBVSxFQUN6QyxDQUVBSixrQkFBQUEsR0FDRXRCLEtBQUtlLGlCQUFpQlksaUJBQWlCLFNBQVMsS0FDOUMzQixLQUFLUSxrQkFBa0JSLEtBQUssSUFFOUJBLEtBQUtnQixXQUFXVyxpQkFBaUIsUUFBUzNCLEtBQUs0QixtQkFDL0M1QixLQUFLbUIsYUFBYVEsaUJBQWlCLFNBQVMsS0FDMUMzQixLQUFLUyxtQkFBbUJULEtBQUssR0FFakMsQ0FFQTRCLGtCQUFvQkEsS0FDYjVCLEtBQUtnQixXQUFXQyxVQUFVWSxTQUFTLDRCQUdsQzdCLEtBQUtnQixXQUFXQyxVQUFVWSxTQUFTLDZCQUNyQzdCLEtBQUtELGdCQUFnQkMsS0FBTUEsS0FBS0MsS0FBTSxjQUh4Q0QsS0FBS0QsZ0JBQWdCQyxLQUFNQSxLQUFLQyxLQUFNLFVBS3hDLEVDekRXLE1BQU02QixFQUNuQnBDLFdBQUFBLENBQVlxQyxFQUFnQkMsR0FDMUJoQyxLQUFLaUMsZUFBaUJGLEVBQWVHLGNBQ3JDbEMsS0FBS21DLHNCQUF3QkosRUFBZUsscUJBQzVDcEMsS0FBS3FDLHFCQUF1Qk4sRUFBZU8sb0JBQzNDdEMsS0FBS3VDLGlCQUFtQlIsRUFBZVMsZ0JBQ3ZDeEMsS0FBS3lDLFlBQWNWLEVBQWVXLFdBQ2xDMUMsS0FBSzJDLFFBQVVYLENBQ2pCLENBRUFZLGdCQUFBQSxHQUNFNUMsS0FBSzJDLFFBQVFoQixpQkFBaUIsVUFBV2tCLElBQ3ZDQSxFQUFFQyxnQkFBZ0IsSUFFcEI5QyxLQUFLc0Isb0JBQ1AsQ0FFQXlCLGVBQUFBLEdBQ0UvQyxLQUFLZ0QscUJBQ3VCaEQsS0FBS2lELFVBQ2JDLFNBQVNDLElBQzNCbkQsS0FBS29ELGdCQUFnQkQsRUFBa0IsR0FFM0MsQ0FFQUUsZ0JBQUFBLEdBQ0UsT0FBUXJELEtBQUtpRCxVQUFVSyxPQUFPQyxHQUFZQSxFQUFRQyxTQUFTQyxPQUM3RCxDQUVBQyxtQkFBQUEsQ0FBb0JILEdBQ2xCLElBQUtBLEVBQVFDLFNBQVNDLE1BQ3BCLE9BQU96RCxLQUFLMkQsZ0JBQWdCSixHQUU5QnZELEtBQUtvRCxnQkFBZ0JHLEVBQ3ZCLENBRUFJLGVBQUFBLENBQWdCSixHQUNkLE1BQU1LLEVBQWlCNUQsS0FBSzJDLFFBQVE5QixjQUFjLElBQUkwQyxFQUFRTSxZQUM5RE4sRUFBUXRDLFVBQVVDLElBQUlsQixLQUFLdUMsa0JBQzNCcUIsRUFBZTlDLFlBQWN5QyxFQUFRTyxrQkFDckNGLEVBQWUzQyxVQUFVQyxJQUFJbEIsS0FBS3lDLFlBQ3BDLENBRUFXLGVBQUFBLENBQWdCRyxHQUNkLE1BQU1LLEVBQWlCNUQsS0FBSzJDLFFBQVE5QixjQUFjLElBQUkwQyxFQUFRTSxZQUM5RE4sRUFBUXRDLFVBQVU4QyxPQUFPL0QsS0FBS3VDLGtCQUM5QnFCLEVBQWU5QyxZQUFjLEtBQzdCOEMsRUFBZTNDLFVBQVU4QyxPQUFPL0QsS0FBS3lDLFlBQ3ZDLENBRUFPLGtCQUFBQSxHQUNFLEdBQUloRCxLQUFLcUQsbUJBR1AsT0FGQXJELEtBQUtnRSxjQUFjL0MsVUFBVUMsSUFBSWxCLEtBQUtxQywyQkFDdENyQyxLQUFLZ0UsY0FBY0MsVUFBVyxHQUdoQ2pFLEtBQUtnRSxjQUFjL0MsVUFBVThDLE9BQU8vRCxLQUFLcUMsc0JBQ3pDckMsS0FBS2dFLGNBQWNDLFVBQVcsQ0FDaEMsQ0FFQTNDLGtCQUFBQSxHQUNFdEIsS0FBS2lELFVBQVksSUFBSWpELEtBQUsyQyxRQUFRdUIsaUJBQWlCbEUsS0FBS2lDLGlCQUN4RGpDLEtBQUtnRSxjQUFnQmhFLEtBQUsyQyxRQUFROUIsY0FBY2IsS0FBS21DLHVCQUNyRG5DLEtBQUtpRCxVQUFVQyxTQUFTSyxJQUN0QkEsRUFBUTVCLGlCQUFpQixTQUFTLEtBQ2hDM0IsS0FBSzBELG9CQUFvQkgsR0FDekJ2RCxLQUFLZ0Qsb0JBQW9CLEdBQ3pCLEdBRU4sRUNsRUssTUFtQk1tQixFQUFvQjVDLFNBQVNWLGNBQ3hDLHlCQUVXdUQsRUFBbUI3QyxTQUFTVixjQUN2Qyw0QkFLV2pCLEVBQWUsaUJBQ2Z5RSxFQUFnQjlDLFNBQVNWLGNBQWMsb0JBQ3ZDeUQsRUFBaUIvQyxTQUFTVixjQUFjLHdCQ2pDdEMsTUFBTTBELEVBQ25CN0UsV0FBQUEsQ0FBWThFLEdBQ1Z4RSxLQUFLeUUsY0FBZ0JsRCxTQUFTVixjQUFjMkQsR0FDNUN4RSxLQUFLMEUsZ0JBQWtCMUUsS0FBSzBFLGdCQUFnQkMsS0FBSzNFLEtBQ25ELENBRUE0RSxJQUFBQSxHQUNFNUUsS0FBS3lFLGNBQWN4RCxVQUFVQyxJQUFJLGdCQUNqQ0ssU0FBU0ksaUJBQWlCLFVBQVczQixLQUFLMEUsZ0JBQzVDLENBRUFHLEtBQUFBLEdBQ0U3RSxLQUFLeUUsY0FBY3hELFVBQVU4QyxPQUFPLGdCQUNwQ3hDLFNBQVN1RCxvQkFBb0IsVUFBVzlFLEtBQUswRSxnQkFDL0MsQ0FFQUEsZUFBQUEsQ0FBZ0I3QixHQUNBLFdBQVZBLEVBQUVrQyxLQUNKL0UsS0FBSzZFLE9BRVQsQ0FFQUcsaUJBQUFBLEdBQ0VoRixLQUFLeUUsY0FBYzlDLGlCQUFpQixhQUFja0IsS0FFOUNBLEVBQUVvQyxPQUFPaEUsVUFBVVksU0FBUyxpQkFDNUJnQixFQUFFb0MsT0FBT2hFLFVBQVVZLFNBQVMsa0JBRTVCN0IsS0FBSzZFLE9BQ1AsR0FFSixFQzdCYSxNQUFNSyxVQUFzQlgsRUFDekM3RSxXQUFBQSxDQUFZOEUsRUFBZVcsR0FDekJDLE1BQU1aLEdBQ054RSxLQUFLcUYsWUFBY3JGLEtBQUt5RSxjQUFjUCxpQkFBaUIsaUJBQ3ZEbEUsS0FBS3NGLFdBQWF0RixLQUFLeUUsY0FBYzVELGNBQWMsZ0JBQ25EYixLQUFLdUYsa0JBQW9CSixFQUN6Qm5GLEtBQUt3RixjQUFnQnhGLEtBQUt3RixjQUFjYixLQUFLM0UsTUFDN0NBLEtBQUt5RixXQUFhekYsS0FBS3lFLGNBQWM1RCxjQUFjLGtCQUNuRGIsS0FBSzBGLGVBQWlCMUYsS0FBS3lGLFdBQVczRSxXQUN4QyxDQUVBMEUsYUFBQUEsQ0FBY0csR0FDWkEsRUFBSTdDLGlCQUNKLE1BQU04QyxFQUFXNUYsS0FBSzZGLGtCQUN0QjdGLEtBQUt1RixrQkFBa0JLLEVBQ3pCLENBRUFFLGFBQUFBLENBQWNDLEdBQXNDLElBQTNCQyxFQUFXQyxVQUFBQyxPQUFBLFFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFHLFlBRW5DakcsS0FBS3lGLFdBQVczRSxZQURkaUYsRUFDNEJDLEVBRUFoRyxLQUFLMEYsY0FFdkMsQ0FFQVUsY0FBQUEsR0FDRXBHLEtBQUtzRixXQUFXZSxPQUNsQixDQUVBUixlQUFBQSxHQUtFLE9BSkE3RixLQUFLc0csV0FBYSxDQUFDLEVBQ25CdEcsS0FBS3FGLFlBQVluQyxTQUFTcUQsSUFDeEJ2RyxLQUFLc0csV0FBV0MsRUFBTXJHLE1BQVFxRyxFQUFNQyxLQUFLLElBRXBDeEcsS0FBS3NHLFVBQ2QsQ0FFQUcsY0FBQUEsQ0FBZTlHLEdBQ2JLLEtBQUtxRixZQUFZbkMsU0FBU3FELElBQ3hCQSxFQUFNQyxNQUFRN0csRUFBSzRHLEVBQU1yRyxLQUFLLEdBRWxDLENBRUE4RSxpQkFBQUEsR0FDRUksTUFBTUosb0JBQ05oRixLQUFLc0YsV0FBVzNELGlCQUFpQixTQUFVM0IsS0FBS3dGLGNBQ2xELEVDaERhLE1BQU1rQixFQUNuQmhILFdBQUFBLENBQVdpSCxFQUFzQnRDLEdBQWUsSUFBcEMsTUFBRXVDLEVBQUssU0FBRUMsR0FBVUYsRUFDN0IzRyxLQUFLOEcsZUFBaUJ6QyxFQUN0QnJFLEtBQUsrRyxPQUFTSCxFQUNkNUcsS0FBS2dILFVBQVlILENBQ25CLENBRUFJLFdBQUFBLEdBQ0VqSCxLQUFLK0csT0FBTzdELFNBQVNnRSxJQUNuQmxILEtBQUtnSCxVQUFVRSxFQUFNLFNBQVMsR0FFbEMsQ0FFQUMsT0FBQUEsQ0FBUUQsR0FBeUIsSUFBbkJFLEVBQU1uQixVQUFBQyxPQUFBLFFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFHLFNBQ3JCakcsS0FBSzhHLGVBQWVNLEdBQVFGLEVBQzlCLEVDYUYsTUFBTUcsRUFBVyxJQzVCRixNQUNiM0gsV0FBQUEsQ0FBWTRILEdBQ1Z0SCxLQUFLdUgsYUFBZWhHLFNBQVNWLGNBQWN5RyxFQUFTcEgsTUFDcERGLEtBQUt3SCxvQkFBc0JqRyxTQUFTVixjQUFjeUcsRUFBU0csYUFDM0R6SCxLQUFLMEgsZUFBaUJuRyxTQUFTVixjQUFjeUcsRUFBU0ssT0FDeEQsQ0FDQUMsV0FBQUEsR0FDRSxNQUFPLENBQ0xDLE1BQU83SCxLQUFLdUgsYUFBYXpHLFlBQ3pCMkcsWUFBYXpILEtBQUt3SCxvQkFBb0IxRyxZQUUxQyxDQUNBZ0gsV0FBQUEsQ0FBV25CLEdBQXdCLElBQXZCLEtBQUV6RyxFQUFJLFlBQUV1SCxHQUFhZCxFQUMvQjNHLEtBQUt1SCxhQUFhekcsWUFBY1osRUFDaENGLEtBQUt3SCxvQkFBb0IxRyxZQUFjMkcsQ0FDekMsQ0FDQU0sYUFBQUEsQ0FBY0osR0FDWjNILEtBQUswSCxlQUFldEcsSUFBTXVHLENBQzVCLEdEVTRCLENBQzVCekgsS0FBTSxpQkFDTnVILFlBQWEsd0JBQ2JFLE9BQVEsb0JBRUpLLEVBQU0sSUVqQ0csTUFDYnRJLFdBQUFBLENBQVdpSCxHQUF1QixJQUF0QixRQUFFc0IsRUFBTyxRQUFFQyxHQUFTdkIsRUFDOUIzRyxLQUFLbUksU0FBV0YsRUFDaEJqSSxLQUFLb0ksU0FBV0YsQ0FDbEIsQ0FFQUcsY0FBQUEsQ0FBZUMsR0FDYixPQUFJQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVOQyxRQUFRQyxPQUFPLFVBQVVKLEVBQUlLLFNBQ3RDLENBRUFDLFFBQUFBLENBQVNDLEVBQUtDLEdBQ1osT0FBT0MsTUFBTS9JLEtBQUttSSxTQUFXVSxFQUFLQyxHQUFTRSxLQUFLaEosS0FBS3FJLGVBQ3ZELENBRUFZLFdBQUFBLENBQVdDLEdBQTZCLElBQTNCdEIsRUFBYXVCLEdBQVlELEVBQ3BDVCxRQUFRVyxJQUFJLENBQUN4QixFQUFhdUIsR0FDNUIsQ0FFQXZCLFdBQUFBLEdBQ0UsT0FBTzVILEtBQUs0SSxTQUFTLFlBQWEsQ0FDaEN4QixPQUFRLE1BQ1JjLFFBQVNsSSxLQUFLb0ksVUFFbEIsQ0FFQU4sV0FBQUEsQ0FBWTVILEVBQU1tSixHQUNoQixPQUFPckosS0FBSzRJLFNBQVMsWUFBYSxDQUNoQ3hCLE9BQVEsUUFDUmMsUUFBU2xJLEtBQUtvSSxTQUNka0IsS0FBTUMsS0FBS0MsVUFBVSxDQUFFdEosT0FBTW1KLFdBRWpDLENBRUFJLFNBQUFBLENBQVVDLEdBQ1IsT0FBTzFKLEtBQUs0SSxTQUFTLG1CQUFvQixDQUN2Q3hCLE9BQVEsUUFDUmMsUUFBU2xJLEtBQUtvSSxTQUNka0IsS0FBTUMsS0FBS0MsVUFBVSxDQUFFN0IsT0FBUStCLEtBRW5DLENBRUFDLGVBQUFBLEdBQ0UsT0FBTzNKLEtBQUs0SSxTQUFTLFNBQVUsQ0FDN0J4QixPQUFRLE1BQ1JjLFFBQVNsSSxLQUFLb0ksVUFFbEIsQ0FFQXdCLE9BQUFBLENBQVFDLEdBQ04sT0FBTzdKLEtBQUs0SSxTQUFTLFNBQVUsQ0FDN0J4QixPQUFRLE9BQ1JjLFFBQVNsSSxLQUFLb0ksU0FDZGtCLEtBQU1DLEtBQUtDLFVBQVUsQ0FBRXRKLEtBQU0ySixFQUFTM0osS0FBTUMsS0FBTTBKLEVBQVMxSixRQUUvRCxDQUVBMkosVUFBQUEsQ0FBVzFKLEdBQ1QsT0FBT0osS0FBSzRJLFNBQVMsVUFBVXhJLElBQVUsQ0FDdkNnSCxPQUFRLFNBQ1JjLFFBQVNsSSxLQUFLb0ksVUFFbEIsQ0FFQTJCLE9BQUFBLENBQVEzSixHQUNOLE9BQU9KLEtBQUs0SSxTQUFTLFVBQVV4SSxVQUFnQixDQUM3Q2dILE9BQVEsTUFDUmMsUUFBU2xJLEtBQUtvSSxVQUVsQixDQUVBNEIsVUFBQUEsQ0FBVzVKLEdBQ1QsT0FBT0osS0FBSzRJLFNBQVMsVUFBVXhJLFVBQWdCLENBQzdDZ0gsT0FBUSxTQUNSYyxRQUFTbEksS0FBS29JLFVBRWxCLEdObEV1QixDQUN2QkgsUUFBUyxrREFDVEMsUUFBUyxDQUNQK0IsY0FBZSx1Q0FDZixlQUFnQixzQklrQmRDLEVBQW1CLElBQUloRixFQUMzQixtQkF5R0YsU0FBNkJvQyxHQUMzQjRDLEVBQWlCcEUsZUFBYyxFQUFNLGFBQ3JDa0MsRUFDR0YsWUFBWVIsRUFBU08sTUFBT1AsRUFBU0csYUFDckN1QixNQUFLLEtBQ0ozQixFQUFTUyxZQUFZLENBQ25CNUgsS0FBTW9ILEVBQVNPLE1BQ2ZKLFlBQWFILEVBQVNHLGFBQ3RCLElBRUh1QixNQUFLLEtBQ0prQixFQUFpQnJGLFFBQ2pCcUYsRUFBaUI5RCxnQkFBZ0IsSUFFbEMrRCxNQUFNQyxRQUFRQyxPQUNkQyxTQUFRLEtBQ1BKLEVBQWlCcEUsZUFBYyxFQUFNLEdBRTNDLElBeEhNeUUsRUFBa0IsSUFBSXJGLEVBQWMsa0JBeUgxQyxTQUE0QnZGLEdBQzFCNEssRUFBZ0J6RSxlQUFjLEVBQU0sYUFDcENrQyxFQUNHeUIsVUFBVTlKLEVBQUtrSixLQUNmRyxNQUFNVixJQUNMakIsRUFBU1UsY0FBY08sRUFBSVgsT0FBTyxJQUVuQ3FCLE1BQUssS0FDSnVCLEVBQWdCMUYsUUFDaEIwRixFQUFnQm5FLGdCQUFnQixJQUVqQytELE1BQU1DLFFBQVFDLE9BQ2RDLFNBQVEsS0FDUEMsRUFBZ0J6RSxlQUFjLEVBQU0sR0FFMUMsSUF2SU0wRSxFQUFjLElBQUk5RCxFQUFRLENBQUMsRUFBR3JDLEdBQzlCb0csRUFBZ0IsSUFBSXZGLEVBQWMsb0JBdUl4QyxTQUEwQnZGLEdBQ3hCOEssRUFBYzNFLGVBQWMsRUFBTSxhQUNsQyxNQUFNbkYsRUFBYyxDQUFFVCxLQUFNUCxFQUFLa0ksTUFBTzFILEtBQU1SLEVBQUtrSixLQUNuRGIsRUFDRzRCLFFBQVFqSixHQUNScUksTUFBTVYsSUFDTDVILEVBQVc0SCxFQUFLLFVBQVUsSUFFM0JVLE1BQUssS0FDSnlCLEVBQWM1RixRQUNkNEYsRUFBY3JFLGdCQUFnQixJQUUvQitELE1BQU1DLFFBQVFDLE9BQ2RDLFNBQVEsS0FDUEcsRUFBYzNFLGVBQWMsRUFBTSxHQUV4QyxJQXRKTTRFLEVBQWlCLElHdkNSLGNBQTZCbkcsRUFDMUM3RSxXQUFBQSxDQUFZOEUsR0FDVlksTUFBTVosR0FDTnhFLEtBQUsySyxhQUFlM0ssS0FBS3lFLGNBQWM1RCxjQUNyQyx5QkFFRmIsS0FBSzRLLGFBQWU1SyxLQUFLeUUsY0FBYzVELGNBQ3JDLDBCQUVKLENBQ0ErRCxJQUFBQSxDQUFLakYsR0FDSEssS0FBSzJLLGFBQWF2SixJQUFNekIsRUFBS1EsS0FDN0JILEtBQUsySyxhQUFhdEosSUFBTTFCLEVBQUtPLEtBQzdCRixLQUFLNEssYUFBYTlKLFlBQWNuQixFQUFLTyxLQUNyQ2tGLE1BQU1SLE1BQ1IsR0h3QndDLDJCQUNwQ2lHLEVBQXFCLElJeENaLGNBQXNDdEcsRUFDbkQ3RSxXQUFBQSxDQUFZOEUsRUFBZVcsR0FDekJDLE1BQU1aLEdBQ054RSxLQUFLc0YsV0FBYXRGLEtBQUt5RSxjQUFjNUQsY0FBYyxnQkFDbkRiLEtBQUt1RixrQkFBb0JKLEVBQ3pCbkYsS0FBSzhLLGFBQWU5SyxLQUFLeUUsY0FBYzVELGNBQWMsaUJBQ3ZELENBRUErRCxJQUFBQSxDQUFLeEUsR0FDSEosS0FBSzhLLGFBQWFoSyxZQUFjLE1BQ2hDZCxLQUFLSSxPQUFTQSxFQUNkZ0YsTUFBTVIsTUFDUixDQUVBSSxpQkFBQUEsR0FDRUksTUFBTUosb0JBQ05oRixLQUFLc0YsV0FBVzNELGlCQUFpQixVQUFVLEtBQ3pDM0IsS0FBSzhLLGFBQWFoSyxZQUFjLFlBQ2hDZCxLQUFLdUYsa0JBQWtCdkYsS0FBS0ksT0FBTyxHQUV2QyxHSnFCQSx1QkE0REYsU0FBeUJILEdBQ3ZCK0gsRUFDRzhCLFdBQVc3SixFQUFLRyxRQUNoQjRJLE1BQUssS0FDSi9JLEVBQUtVLFlBQVlvRCxTQUNqQjlELEVBQUtVLFlBQWMsSUFBSSxJQUV4QnFJLEtBQUs2QixFQUFtQmhHLFNBQ3hCc0YsTUFBTUMsUUFBUUMsTUFDbkIsSUFsRWEsSUFBSTVLLEVKWlUsQ0FBQyxFSWMxQkcsRUFDQUMsRUFDQUMsRUFDQUMsR0FLRjBJLFFBQVFXLElBQUksQ0FBQ3BCLEVBQUlKLGNBQWVJLEVBQUkyQixvQkFDakNYLE1BQU1WLElBQ0wsTUFBTWhCLEVBQVdnQixFQUFJLEdBQ2Z5QyxFQUFRQyxNQUFNQyxLQUFLM0MsRUFBSSxLQXlFakMsU0FBK0JoQixHQUM3QkQsRUFBU1MsWUFBWSxDQUNuQjVILEtBQU1vSCxFQUFTcEgsS0FDZnVILFlBQWFILEVBQVMrQixRQUV4QmhDLEVBQVNVLGNBQWNULEVBQVNLLE9BQ2xDLENBOUVJdUQsQ0FBc0I1RCxHQW9CRCxJQUFJWixFQUN6QixDQUFFRSxNQXBCZ0JtRSxFQW9CQ2xFLFNBQVVuRyxHQUM3QjJELEdBRWE0QyxhQXZCVyxJQUV6QmtELE1BQU1DLFFBQVFDLE9BRWpCLE1BQU1jLEVBQWlCLENBQUMsRUFxQnhCLFNBQVN6SyxFQUFXd0csR0FBeUIsSUFBbkJFLEVBQU1uQixVQUFBQyxPQUFBLFFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFHLFNBQ2pDLE1BT010RixFQVBPLElBQUlsQixFQUNmeUgsRUFDQXRILEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBRXVCVyxhQUN6QjhKLEVBQVlyRCxRQUFReEcsRUFBYXlHLEVBQ25DLENBQ0EsU0FBU3ZILEVBQWlCRixHQUN4QitLLEVBQWU5RixLQUFLakYsRUFDdEIsQ0FDQSxTQUFTRyxFQUFrQitKLEdBQ3pCZ0IsRUFBbUJqRyxLQUFLaUYsRUFDMUIsQ0FXQSxTQUFTOUosRUFBZ0I4SixFQUFVNUosRUFBTW1MLEdBQ3BCLFlBQWZBLEdBQ0ZwRCxFQUNHK0IsUUFBUTlKLEVBQUtJLEtBQ2IySSxLQUFLYSxFQUFTN0ksV0FBV0MsVUFBVUMsSUFBSSw2QkFDdkNpSixPQUFPa0IsSUFDTmpCLFFBQVFDLE1BQU1nQixFQUFJLElBR0wsZUFBZkQsR0FDRnBELEVBQ0dnQyxXQUFXL0osRUFBS0ksS0FDaEIySSxLQUFLYSxFQUFTN0ksV0FBV0MsVUFBVThDLE9BQU8sNkJBQzFDb0csT0FBT2tCLElBQ05qQixRQUFRQyxNQUFNZ0IsRUFBSSxHQUcxQixDQWhFMEJDLFFKL0RKLENBQ3BCcEosY0FBZSxnQkFDZkUscUJBQXNCLGlCQUN0QkUsb0JBQXFCLHlCQUNyQkUsZ0JBQWlCLDBCQUNqQkUsV0FBWSx1QkFDWjZJLGFBQWMsZ0JJMERHUCxNQUFNQyxLQUFLMUosU0FBUzJDLGlCQUFpQm9ILEVBQU9DLGVBQ3BEckksU0FBU3NJLElBQ2hCLE1BQU1DLEVBQVksSUFBSTNKLEVBQWN3SixFQUFRRSxHQUN0Q0UsRUFBV0YsRUFBWUcsYUFBYSxRQUMxQ1IsRUFBZU8sR0FBWUQsRUFDM0JBLEVBQVU3SSxrQkFBa0IsSUEySGhDdUIsRUFBa0J4QyxpQkFBaUIsU0FBUyxXQUMxQyxNQUFNMkYsRUFBV0QsRUFBU08sY0FDMUJzQyxFQUFpQnpELGVBQWVhLEdBQ2hDNkQsRUFBZSxnQkFBZ0JwSSxrQkFDL0JtSCxFQUFpQnRGLE1BQ25CLElBQ0FOLEVBQWUzQyxpQkFBaUIsU0FBUyxLQUN2Q3dKLEVBQWUsYUFBYXBJLGtCQUM1QjBILEVBQWM3RixNQUFNLElBRXRCUixFQUFpQnpDLGlCQUFpQixTQUFTLEtBQ3pDd0osRUFBZSxlQUFlcEksa0JBQzlCd0gsRUFBZ0IzRixNQUFNLElBRXhCOEYsRUFBZTFGLG9CQUNma0YsRUFBaUJsRixvQkFDakJ1RixFQUFnQnZGLG9CQUNoQnlGLEVBQWN6RixvQkFDZDZGLEVBQW1CN0YsbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cERlbGV0ZUNvbmZpcm1hdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGRhdGEsXHJcbiAgICBjYXJkU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQ2xpY2tcclxuICApIHtcclxuICAgIHRoaXMuY2FyZCA9IGRhdGE7XHJcbiAgICB0aGlzLm5hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLmxpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLmNhcmRJRCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gICAgdGhpcy5oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgfVxyXG5cclxuICByZW5kZXJDYXJkKCkge1xyXG4gICAgdGhpcy5jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLmNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLm5hbWU7XHJcbiAgICB0aGlzLmNhcmRJbWFnZUVsZW1lbnQgPSB0aGlzLmNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLmxpa2VCdXR0b24gPSB0aGlzLmNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICBpZiAodGhpcy5pc0xpa2VkKSB7XHJcbiAgICAgIHRoaXMubGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5kZWxldGVCdXR0b24gPSB0aGlzLmNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuY2FyZEltYWdlRWxlbWVudC5zcmMgPSB0aGlzLmxpbms7XHJcbiAgICB0aGlzLmNhcmRJbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5uYW1lO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHJldHVybiB0aGlzLmNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQuY2xvbmVOb2RlKHRydWUpO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcyk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMubGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbik7XHJcbiAgICB0aGlzLmRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VCdXR0b24gPSAoKSA9PiB7XHJcbiAgICBpZiAoIXRoaXMubGlrZUJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIikpIHtcclxuICAgICAgdGhpcy5oYW5kbGVMaWtlQ2xpY2sodGhpcywgdGhpcy5jYXJkLCBcImFkZExpa2VcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAodGhpcy5saWtlQnV0dG9uLmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKSkge1xyXG4gICAgICAgIHRoaXMuaGFuZGxlTGlrZUNsaWNrKHRoaXMsIHRoaXMuY2FyZCwgXCJyZW1vdmVMaWtlXCIpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5nc09iamVjdCwgZm9ybUVsKSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3NPYmplY3QuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3NPYmplY3Quc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3NPYmplY3QuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzT2JqZWN0LmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5nc09iamVjdC5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZm9ybUVsID0gZm9ybUVsO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VJbnB1dEVsID0gdGhpcy5faW5wdXRFbHM7XHJcbiAgICBlcnJvck1lc3NhZ2VJbnB1dEVsLmZvckVhY2goKGVycm9yTWVzc2FnZUlucHV0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGVycm9yTWVzc2FnZUlucHV0KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiAhdGhpcy5faW5wdXRFbHMuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XHJcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IG51bGw7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsIi8qKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqICAgICAgIEZvcm1WYWxpZGF0b3IgQ29uZmlnIE9iamVjdFxyXG4gKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSoqL1xyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBhcGlDb25maWcgPSB7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiN2Q2MWYyZGEtNGRkZi00MGI4LWFkZWMtZWFkZTZjMmRiNDc4XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59O1xyXG4vKio9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gKiBQcm9maWxlIGFuZCBwcm9maWxlIG1vZGFsIHNlbGVjdG9yIHZhcmlhYmxlc1xyXG4gKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSoqL1xyXG5leHBvcnQgY29uc3Qgb3BlblByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IG9wZW5BdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX292ZXJsYXktYnV0dG9uXCJcclxuKTtcclxuLyoqPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICogICAgICAgQ2FyZCB0ZW1wbGF0ZSBzZWxlY3RvciB2YXJpYWJsZXNcclxuICo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qKi9cclxuZXhwb3J0IGNvbnN0IGNhcmRTZWxlY3RvciA9IFwiI2NhcmQtdGVtcGxhdGVcIjtcclxuZXhwb3J0IGNvbnN0IGNhcmRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2NvbnRhaW5lclwiKTtcclxuZXhwb3J0IGNvbnN0IG9wZW5DYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgY2FyZEVsZW1lbnQgPSB7fTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlKGUpIHtcclxuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChlKSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikgfHxcclxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fZm9ybUlucHV0cyA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSB0aGlzLl9oYW5kbGVTdWJtaXQuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ0biA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG5UZXh0ID0gdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZVN1Ym1pdChldnQpIHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc3QgZm9ybURhdGEgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdChmb3JtRGF0YSk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnRuVGV4dDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHBvcHVwRm9ybVJlc2V0KCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dERhdGEgPSB7fTtcclxuICAgIHRoaXMuX2Zvcm1JbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5faW5wdXREYXRhW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dERhdGE7XHJcbiAgfVxyXG5cclxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XHJcbiAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5faGFuZGxlU3VibWl0KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY2FyZENvbnRhaW5lcikge1xyXG4gICAgdGhpcy5fY2FyZENvbnRhaW5lciA9IGNhcmRDb250YWluZXI7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtLCBcImFwcGVuZFwiKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShpdGVtLCBtZXRob2QgPSBcImFwcGVuZFwiKSB7XHJcbiAgICB0aGlzLl9jYXJkQ29udGFpbmVyW21ldGhvZF0oaXRlbSk7XHJcbiAgfVxyXG59XHJcbiIsIi8qKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqICAgICAgICAgIEltcG9ydCBDU1MgZm9yIFdlYnBhY2tcclxuICo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qKi9cclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuLyoqPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICogICAgICAgICAgSW1wb3J0IENsYXNzZXMgYW5kIE9iamVjdHNcclxuICo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qKi9cclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgY29uZmlnLFxyXG4gIGFwaUNvbmZpZyxcclxuICBvcGVuUHJvZmlsZUJ1dHRvbixcclxuICBvcGVuQXZhdGFyQnV0dG9uLFxyXG4gIGNhcmRTZWxlY3RvcixcclxuICBjYXJkQ29udGFpbmVyLFxyXG4gIG9wZW5DYXJkQnV0dG9uLFxyXG4gIGNhcmRFbGVtZW50LFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwRGVsZXRlQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwRGVsZXRlQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcbi8qKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqICAgICAgICAgICAgQ2xhc3MgSW5zdGFudGlhdGlvbnNcclxuICo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0qKi9cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWU6IFwiLnByb2ZpbGVfX25hbWVcIixcclxuICBkZXNjcmlwdGlvbjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcclxuICBhdmF0YXI6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXHJcbn0pO1xyXG5jb25zdCBhcGkgPSBuZXcgQXBpKGFwaUNvbmZpZyk7XHJcbmNvbnN0IHByb2ZpbGVQb3B1cEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNtb2RhbF9fcHJvZmlsZVwiLFxyXG4gIGhhbmRsZVByb2ZpbGVTdWJtaXRcclxuKTtcclxuY29uc3QgYXZhdGFyUG9wdXBGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjbW9kYWxfX2F2YXRhclwiLCBoYW5kbGVBdmF0YXJTdWJtaXQpO1xyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKHt9LCBjYXJkQ29udGFpbmVyKTtcclxuY29uc3QgY2FyZFBvcHVwRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI21vZGFsX19hZGQtY2FyZFwiLCBoYW5kbGVDYXJkU3VibWl0KTtcclxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjbW9kYWxfX3ByZXZpZXctd3JhcHBlclwiKTtcclxuY29uc3QgZGVsZXRlQ29uZmlybWF0aW9uID0gbmV3IFBvcHVwRGVsZXRlQ29uZmlybWF0aW9uKFxyXG4gIFwiI21vZGFsX19kZWxldGUtY2FyZFwiLFxyXG4gIGRlbGV0ZUNvbmZpcm1lZFxyXG4pO1xyXG5jb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgY2FyZEVsZW1lbnQsXHJcbiAgY2FyZFNlbGVjdG9yLFxyXG4gIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgaGFuZGxlRGVsZXRlQ2xpY2ssXHJcbiAgaGFuZGxlTGlrZUNsaWNrXHJcbik7XHJcbi8qKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqICAgICAgVmFsaWRhdGlvbiBhbmQgQ2FyZCBDbGFzcyBDYWxsc1xyXG4gKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSoqL1xyXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgY29uc3QgdXNlckRhdGEgPSByZXNbMF07XHJcbiAgICBjb25zdCBjYXJkcyA9IEFycmF5LmZyb20ocmVzWzFdKTtcclxuICAgIGdldEluaXRpYWxBcGlVc2VySW5mbyh1c2VyRGF0YSk7XHJcbiAgICBoYW5kbGVBcGlDYXJkSW5mbyhjYXJkcyk7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcblxyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBmb3JtRWxlbWVudCk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5lbmFibGVWYWxpZGF0aW9uKGNvbmZpZyk7XHJcbi8qKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAqICAgICAgICAgICAgICAgRnVuY3Rpb25zXHJcbiAqPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09KiovXHJcbmZ1bmN0aW9uIGhhbmRsZUFwaUNhcmRJbmZvKGNhcmREYXRhKSB7XHJcbiAgY29uc3QgY2FyZEFwaVNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICAgIHsgaXRlbXM6IGNhcmREYXRhLCByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LFxyXG4gICAgY2FyZENvbnRhaW5lclxyXG4gICk7XHJcbiAgY2FyZEFwaVNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxufVxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGl0ZW0sIG1ldGhvZCA9IFwiYXBwZW5kXCIpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBpdGVtLFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxyXG4gICAgaGFuZGxlTGlrZUNsaWNrXHJcbiAgKTtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQucmVuZGVyQ2FyZCgpO1xyXG4gIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQsIG1ldGhvZCk7XHJcbn1cclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhkYXRhKSB7XHJcbiAgcG9wdXBXaXRoSW1hZ2Uub3BlbihkYXRhKTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDbGljayhjYXJkRGF0YSkge1xyXG4gIGRlbGV0ZUNvbmZpcm1hdGlvbi5vcGVuKGNhcmREYXRhKTtcclxufVxyXG5mdW5jdGlvbiBkZWxldGVDb25maXJtZWQoY2FyZCkge1xyXG4gIGFwaVxyXG4gICAgLmRlbGV0ZUNhcmQoY2FyZC5jYXJkSUQpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGNhcmQuY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgIGNhcmQuY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gICAgfSlcclxuICAgIC50aGVuKGRlbGV0ZUNvbmZpcm1hdGlvbi5jbG9zZSgpKVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhjYXJkRGF0YSwgY2FyZCwgbGlrZUFjdGlvbikge1xyXG4gIGlmIChsaWtlQWN0aW9uID09PSBcImFkZExpa2VcIikge1xyXG4gICAgYXBpXHJcbiAgICAgIC5hZGRMaWtlKGNhcmQuX2lkKVxyXG4gICAgICAudGhlbihjYXJkRGF0YS5saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIikpXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICB9KTtcclxuICB9XHJcbiAgaWYgKGxpa2VBY3Rpb24gPT09IFwicmVtb3ZlTGlrZVwiKSB7XHJcbiAgICBhcGlcclxuICAgICAgLmRlbGV0ZUxpa2UoY2FyZC5faWQpXHJcbiAgICAgIC50aGVuKGNhcmREYXRhLmxpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0SW5pdGlhbEFwaVVzZXJJbmZvKHVzZXJEYXRhKSB7XHJcbiAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgbmFtZTogdXNlckRhdGEubmFtZSxcclxuICAgIGRlc2NyaXB0aW9uOiB1c2VyRGF0YS5hYm91dCxcclxuICB9KTtcclxuICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHVzZXJEYXRhLmF2YXRhcik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVTdWJtaXQodXNlckRhdGEpIHtcclxuICBwcm9maWxlUG9wdXBGb3JtLnJlbmRlckxvYWRpbmcodHJ1ZSwgXCJTYXZpbmcuLi5cIik7XHJcbiAgYXBpXHJcbiAgICAuc2V0VXNlckluZm8odXNlckRhdGEudGl0bGUsIHVzZXJEYXRhLmRlc2NyaXB0aW9uKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgbmFtZTogdXNlckRhdGEudGl0bGUsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IHVzZXJEYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICB9KTtcclxuICAgIH0pXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVQb3B1cEZvcm0uY2xvc2UoKTtcclxuICAgICAgcHJvZmlsZVBvcHVwRm9ybS5wb3B1cEZvcm1SZXNldCgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwcm9maWxlUG9wdXBGb3JtLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGRhdGEpIHtcclxuICBhdmF0YXJQb3B1cEZvcm0ucmVuZGVyTG9hZGluZyh0cnVlLCBcIlNhdmluZy4uLlwiKTtcclxuICBhcGlcclxuICAgIC5zZXRBdmF0YXIoZGF0YS51cmwpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIocmVzLmF2YXRhcik7XHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBhdmF0YXJQb3B1cEZvcm0uY2xvc2UoKTtcclxuICAgICAgYXZhdGFyUG9wdXBGb3JtLnBvcHVwRm9ybVJlc2V0KCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGF2YXRhclBvcHVwRm9ybS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRTdWJtaXQoZGF0YSkge1xyXG4gIGNhcmRQb3B1cEZvcm0ucmVuZGVyTG9hZGluZyh0cnVlLCBcIlNhdmluZy4uLlwiKTtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IHsgbmFtZTogZGF0YS50aXRsZSwgbGluazogZGF0YS51cmwgfTtcclxuICBhcGlcclxuICAgIC5hZGRDYXJkKGNhcmRFbGVtZW50KVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZW5kZXJDYXJkKHJlcywgXCJwcmVwZW5kXCIpO1xyXG4gICAgfSlcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgY2FyZFBvcHVwRm9ybS5jbG9zZSgpO1xyXG4gICAgICBjYXJkUG9wdXBGb3JtLnBvcHVwRm9ybVJlc2V0KCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGNhcmRQb3B1cEZvcm0ucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG4vKio9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gKiAgICAgICAgICAgICAgIEV2ZW50IExpc3RlbmVyc1xyXG4gKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSoqL1xyXG5vcGVuUHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBwcm9maWxlUG9wdXBGb3JtLnNldElucHV0VmFsdWVzKHVzZXJEYXRhKTtcclxuICBmb3JtVmFsaWRhdG9yc1tcInByb2ZpbGUtZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICBwcm9maWxlUG9wdXBGb3JtLm9wZW4oKTtcclxufSk7XHJcbm9wZW5DYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJjYXJkLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgY2FyZFBvcHVwRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG5vcGVuQXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJhdmF0YXItZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICBhdmF0YXJQb3B1cEZvcm0ub3BlbigpO1xyXG59KTtcclxucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxucHJvZmlsZVBvcHVwRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5hdmF0YXJQb3B1cEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuY2FyZFBvcHVwRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5kZWxldGVDb25maXJtYXRpb24uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHVzZXJEYXRhKSB7XHJcbiAgICB0aGlzLl9wcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckRhdGEubmFtZSk7XHJcbiAgICB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJEYXRhLmRlc2NyaXB0aW9uKTtcclxuICAgIHRoaXMuX3Byb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJEYXRhLmF2YXRhcik7XHJcbiAgfVxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdGl0bGU6IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5fcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuICB9XHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBkZXNjcmlwdGlvbiB9KSB7XHJcbiAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcclxuICB9XHJcbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVBdmF0YXIuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgX3JlcXVlc3QodXJsLCBvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArIHVybCwgb3B0aW9ucykudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGluaXRpYWxTaXRlKFtnZXRVc2VySW5mbywgZ2V0Q2FyZEluZm9dKSB7XHJcbiAgICBQcm9taXNlLmFsbChbZ2V0VXNlckluZm8sIGdldENhcmRJbmZvXSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiL3VzZXJzL21lXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhuYW1lLCBhYm91dCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWVcIiwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBhYm91dCB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0QXZhdGFyKGF2YXRhclVybCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWUvYXZhdGFyXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyOiBhdmF0YXJVcmwgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiL2NhcmRzXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkKGNhcmREYXRhKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi9jYXJkc1wiLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZTogY2FyZERhdGEubmFtZSwgbGluazogY2FyZERhdGEubGluayB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSUQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAvY2FyZHMvJHtjYXJkSUR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZExpa2UoY2FyZElEKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgL2NhcmRzLyR7Y2FyZElEfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVMaWtlKGNhcmRJRCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYC9jYXJkcy8ke2NhcmRJRH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5pbWFnZVByZXZpZXcgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIlxyXG4gICAgKTtcclxuICAgIHRoaXMuaW1hZ2VDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLm1vZGFsX19wcmV2aWV3LWNhcHRpb25cIlxyXG4gICAgKTtcclxuICB9XHJcbiAgb3BlbihkYXRhKSB7XHJcbiAgICB0aGlzLmltYWdlUHJldmlldy5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLmltYWdlUHJldmlldy5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLmltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cERlbGV0ZUNvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9wb3B1cEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKGNhcmRJRCkge1xyXG4gICAgdGhpcy5fcG9wdXBCdXR0b24udGV4dENvbnRlbnQgPSBcIlllc1wiO1xyXG4gICAgdGhpcy5jYXJkSUQgPSBjYXJkSUQ7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX3BvcHVwQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLmNhcmRJRCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJ0aGlzIiwiY2FyZCIsIm5hbWUiLCJsaW5rIiwiY2FyZElEIiwiX2lkIiwiaXNMaWtlZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsInJlbmRlckNhcmQiLCJjYXJkRWxlbWVudCIsIl9nZXRUZW1wbGF0ZSIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsImNhcmRJbWFnZUVsZW1lbnQiLCJsaWtlQnV0dG9uIiwiY2xhc3NMaXN0IiwiYWRkIiwiZGVsZXRlQnV0dG9uIiwic3JjIiwiYWx0IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJjbG9uZU5vZGUiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJjb250YWlucyIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5nc09iamVjdCIsImZvcm1FbCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWwiLCJlbmFibGVWYWxpZGF0aW9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2lucHV0RWxzIiwiZm9yRWFjaCIsImVycm9yTWVzc2FnZUlucHV0IiwiX2hpZGVJbnB1dEVycm9yIiwiX2hhc0ludmFsaWRJbnB1dCIsImV2ZXJ5IiwiaW5wdXRFbCIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3Nob3dJbnB1dEVycm9yIiwiZXJyb3JNZXNzYWdlRWwiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwicmVtb3ZlIiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwicXVlcnlTZWxlY3RvckFsbCIsIm9wZW5Qcm9maWxlQnV0dG9uIiwib3BlbkF2YXRhckJ1dHRvbiIsImNhcmRDb250YWluZXIiLCJvcGVuQ2FyZEJ1dHRvbiIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9mb3JtSW5wdXRzIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2hhbmRsZVN1Ym1pdCIsIl9zdWJtaXRCdG4iLCJfc3VibWl0QnRuVGV4dCIsImV2dCIsImZvcm1EYXRhIiwiX2dldElucHV0VmFsdWVzIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwicG9wdXBGb3JtUmVzZXQiLCJyZXNldCIsIl9pbnB1dERhdGEiLCJpbnB1dCIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJTZWN0aW9uIiwiX3JlZiIsIml0ZW1zIiwicmVuZGVyZXIiLCJfY2FyZENvbnRhaW5lciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJtZXRob2QiLCJ1c2VySW5mbyIsInVzZXJEYXRhIiwiX3Byb2ZpbGVOYW1lIiwiX3Byb2ZpbGVEZXNjcmlwdGlvbiIsImRlc2NyaXB0aW9uIiwiX3Byb2ZpbGVBdmF0YXIiLCJhdmF0YXIiLCJnZXRVc2VySW5mbyIsInRpdGxlIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJ0aGVuIiwiaW5pdGlhbFNpdGUiLCJfcmVmMiIsImdldENhcmRJbmZvIiwiYWxsIiwiYWJvdXQiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInNldEF2YXRhciIsImF2YXRhclVybCIsImdldEluaXRpYWxDYXJkcyIsImFkZENhcmQiLCJjYXJkRGF0YSIsImRlbGV0ZUNhcmQiLCJhZGRMaWtlIiwiZGVsZXRlTGlrZSIsImF1dGhvcml6YXRpb24iLCJwcm9maWxlUG9wdXBGb3JtIiwiY2F0Y2giLCJjb25zb2xlIiwiZXJyb3IiLCJmaW5hbGx5IiwiYXZhdGFyUG9wdXBGb3JtIiwiY2FyZFNlY3Rpb24iLCJjYXJkUG9wdXBGb3JtIiwicG9wdXBXaXRoSW1hZ2UiLCJpbWFnZVByZXZpZXciLCJpbWFnZUNhcHRpb24iLCJkZWxldGVDb25maXJtYXRpb24iLCJfcG9wdXBCdXR0b24iLCJjYXJkcyIsIkFycmF5IiwiZnJvbSIsImdldEluaXRpYWxBcGlVc2VySW5mbyIsImZvcm1WYWxpZGF0b3JzIiwibGlrZUFjdGlvbiIsImVyciIsImNvbmZpZyIsImZvcm1TZWxlY3RvciIsImZvcm1FbGVtZW50IiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiXSwic291cmNlUm9vdCI6IiJ9